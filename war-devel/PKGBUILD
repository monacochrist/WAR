pkgname=war-devel
pkgver=0.0.0
pkgrel=16
pkgdesc="WAR development files (headers)"
arch=('x86_64')
url="https://github.com/monacochrist/WAR"
license=('custom:WAR')

depends=('pipewire')
makedepends=('git' 'pkgconf')

source=("WAR::git+https://github.com/monacochrist/WAR.git")
sha256sums=('SKIP')

build() {
    cd "$srcdir/WAR" || exit 1
    make H_BUILD_DIR=src/h
}

package() {
    cd "$srcdir/WAR" || exit 1

    make install-devel DESTDIR="$pkgdir" PREFIX=/usr

    install -d "$pkgdir/usr/lib/pkgconfig"

    version="$(git log -1 --format=%cd --date=format:%Y%m%d%H%M)-$(git rev-parse --short HEAD)"

    cat > "$pkgdir/usr/lib/pkgconfig/war-devel.pc" <<EOF
prefix=/usr
includedir=\${prefix}/include/war

Name: war-devel
Description: WAR development files
Version: $version
Requires: libpipewire-0.3
Cflags: -I\${includedir}
EOF
}
